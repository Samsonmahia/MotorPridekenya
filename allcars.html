<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotorPride | All Cars</title>
    <style>
        /* CSS remains exactly the same - it's already well organized */
        :root {
            --primary-color: #1a73e8;
            --secondary-color: #f8f9fa;
            --accent-color: #ff6b35;
            --text-color: #333;
            --light-text: #666;
            --border-color: #e0e0e0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* ... (all your existing CSS remains exactly the same) ... */
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">motorpride</div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="#" class="active">All Cars</a></li>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main class="container">
        <h1 class="page-title">Our Vehicle Collection</h1>
        
        <div class="debug-info" id="debugInfo">
            Loading cars data...
        </div>
        
        <div class="cars-grid" id="carsGrid">
            <div class="no-results">
                <div class="no-results-icon">üîÑ</div>
                <h3 class="no-results-title">Loading Vehicles...</h3>
                <p class="no-results-text">Please wait while we load our vehicle collection.</p>
            </div>
        </div>
        
        <div class="pagination">
            <button id="prevPage" disabled>Previous</button>
            <div class="page-numbers">
                <span id="currentPage">1</span> / <span id="totalPages">1</span>
            </div>
            <button id="nextPage">Next</button>
        </div>
    </main>

    <div class="modal-overlay" id="carModal">
        <div class="car-detail-modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalCarTitle">Car Details</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="modal-content">
                <div class="car-images">
                    <img src="" alt="Car Image" class="primary-image" id="modalPrimaryImage">
                    <div class="thumbnails" id="modalThumbnails"></div>
                </div>
                <div class="car-details" id="carDetails"></div>
            </div>
            <div class="modal-footer">
                <div class="nav-buttons">
                    <button class="nav-btn" id="prevCar">Previous Car</button>
                    <button class="nav-btn" id="nextCar">Next Car</button>
                </div>
                <button class="modal-reserve-btn" id="modalReserveBtn">Reserve This Car</button>
            </div>
        </div>
    </div>

    <div class="contacts-modal" id="contactsModal">
        <div class="contacts-header">
            <h3 class="contacts-title">Contact Our Team</h3>
            <button class="close-contacts" id="closeContacts">&times;</button>
        </div>
        <div class="contacts-list" id="contactsList"></div>
    </div>
<script>
/* ===============================
   CONFIGURATION
================================= */
const CONFIG = {
  carsPerPage: 12,
  maxThumbnails: 7,
  animationDelay: 100
};

const ENDPOINTS = {
  cars: [
    './data/cars/mazda.json',
    './data/cars/cx-5.json',
    './data/cars/mercedes-benz.json',
    './data/cars/suzuki.json',
    './data/cars/volvo.json'
  ],
  contacts: [
    './data/contacts/sam.json',
    './data/contacts/kiarie.json'
  ]
};

/* ===============================
   STATE MANAGEMENT
================================= */
const state = {
  cars: [],
  contacts: [],
  currentPage: 1,
  totalPages: 1,
  currentCarIndex: 0
};

/* ===============================
   DOM ELEMENTS
================================= */
const elements = {
  carsGrid: document.getElementById('carsGrid'),
  carModal: document.getElementById('carModal'),
  contactsModal: document.getElementById('contactsModal'),
  closeModal: document.getElementById('closeModal'),
  closeContacts: document.getElementById('closeContacts'),
  prevPage: document.getElementById('prevPage'),
  nextPage: document.getElementById('nextPage'),
  currentPageEl: document.getElementById('currentPage'),
  totalPagesEl: document.getElementById('totalPages'),
  prevCar: document.getElementById('prevCar'),
  nextCar: document.getElementById('nextCar'),
  modalReserveBtn: document.getElementById('modalReserveBtn'),
  debugInfo: document.getElementById('debugInfo'),
  modalCarTitle: document.getElementById('modalCarTitle'),
  modalPrimaryImage: document.getElementById('modalPrimaryImage'),
  modalThumbnails: document.getElementById('modalThumbnails'),
  carDetails: document.getElementById('carDetails'),
  contactsList: document.getElementById('contactsList')
};

/* ===============================
   UTILITIES
================================= */
const utils = {
  showLoadingState() {
    elements.carsGrid.innerHTML = `
      <div class="no-results">
        <div class="no-results-icon">üöó</div>
        <h3 class="no-results-title">Loading Vehicles...</h3>
        <p class="no-results-text">Please wait while we load our car listings.</p>
      </div>
    `;
  },
  showErrorState(msg = 'Failed to load cars') {
    elements.carsGrid.innerHTML = `
      <div class="no-results">
        <div class="no-results-icon">‚ö†Ô∏è</div>
        <h3 class="no-results-title">${msg}</h3>
        <p class="no-results-text">Please check back later.</p>
      </div>
    `;
  },
  formatWhatsApp(number) {
    return number.replace(/\s+/g, '').replace(/[^0-9]/g, '');
  }
};

/* ===============================
   DATA MANAGEMENT
================================= */
const dataManager = {
  async loadCars() {
    try {
      const responses = await Promise.all(
        ENDPOINTS.cars.map(url => fetch(url).then(res => res.ok ? res.json() : null))
      );
      // Combine all arrays or single car objects
      state.cars = responses
        .filter(Boolean)
        .flatMap(car => Array.isArray(car) ? car : [car]);
      
      elements.debugInfo.textContent = `‚úÖ Successfully loaded ${state.cars.length} cars from CMS`;
      console.log('Loaded cars:', state.cars);
    } catch (err) {
      console.error('Error loading cars:', err);
      utils.showErrorState();
    }
  },
  async loadContacts() {
    try {
      const responses = await Promise.all(
        ENDPOINTS.contacts.map(url => fetch(url).then(res => res.ok ? res.json() : null))
      );
      state.contacts = responses.filter(Boolean);
    } catch {
      console.warn('Failed to load contacts');
    }
  }
};

/* ===============================
   RENDERING
================================= */
const renderer = {
  displayCars() {
    const start = (state.currentPage - 1) * CONFIG.carsPerPage;
    const end = start + CONFIG.carsPerPage;
    const carsToShow = state.cars.slice(start, end);

    if (!carsToShow.length) {
      utils.showErrorState('No cars found.');
      return;
    }

    elements.carsGrid.innerHTML = carsToShow.map(car => `
      <div class="car-card" onclick="modalManager.openCarModal(${car.id})">
        <img src="${car.images?.[0] || 'https://via.placeholder.com/400x300?text=No+Image'}" alt="${car.name}">
        <div class="car-info">
          <h3>${car.name}</h3>
          <p>${car.price || 'Price: N/A'}</p>
          <p>${car.fuel || ''} | ${car.year || ''}</p>
        </div>
      </div>
    `).join('');

    state.totalPages = Math.ceil(state.cars.length / CONFIG.carsPerPage);
    this.updatePagination();
  },
  updatePagination() {
    elements.currentPageEl.textContent = state.currentPage;
    elements.totalPagesEl.textContent = state.totalPages;
  }
};

/* ===============================
   MODALS
================================= */
const modalManager = {
  openCarModal(carId) {
    const car = state.cars.find(c => c.id === carId);
    if (!car) return;

    elements.modalCarTitle.textContent = car.name;
    elements.modalPrimaryImage.src = car.images[0];

    // Render thumbnails
    elements.modalThumbnails.innerHTML = car.images
      .slice(0, CONFIG.maxThumbnails)
      .map((img, i) => `<img src="${img}" class="thumbnail" alt="Image ${i + 1}" onclick="elements.modalPrimaryImage.src='${img}'">`)
      .join('');

    // Render details
    elements.carDetails.innerHTML = `
      <div class="detail"><strong>Price:</strong> ${car.price}</div>
      <div class="detail"><strong>Year:</strong> ${car.year}</div>
      <div class="detail"><strong>Fuel:</strong> ${car.fuel}</div>
      <div class="detail"><strong>Transmission:</strong> ${car.transmission}</div>
      <div class="detail"><strong>Engine:</strong> ${car.engine}</div>
      <div class="detail"><strong>Mileage:</strong> ${car.mileage}</div>
      <div class="detail"><strong>Features:</strong> 
        <ul>${car.features?.map(f => `<li>${f}</li>`).join('') || 'N/A'}</ul>
      </div>
    `;
    elements.carModal.classList.add('active');
  },
  closeCarModal() {
    elements.carModal.classList.remove('active');
  }
};

/* ===============================
   EVENTS
================================= */
document.addEventListener('DOMContentLoaded', async () => {
  utils.showLoadingState();
  await dataManager.loadCars();
  await dataManager.loadContacts();
  renderer.displayCars();
});

elements.closeModal?.addEventListener('click', modalManager.closeCarModal);
elements.prevPage?.addEventListener('click', () => {
  if (state.currentPage > 1) {
    state.currentPage--;
    renderer.displayCars();
  }
});
elements.nextPage?.addEventListener('click', () => {
  if (state.currentPage < state.totalPages) {
    state.currentPage++;
    renderer.displayCars();
  }
});
</script>

</body>
</html>