<!-- FEATURED VEHICLES SECTION -->
<section class="featured-cars" id="featured-cars">
  <div class="container">
    <div class="section-title">
      <h2>Featured Vehicles</h2>
    </div>

    <div class="cars-grid" id="featuredCarsContainer">
      <!-- Cars will be loaded here by JavaScript -->
    </div>

    <div class="text-center mt-4">
      <a href="ALLCARS.html" class="view-all-btn">View All Vehicles</a>
    </div>
  </div>
</section>

<!-- Car Details Modal -->
<div class="modal-overlay" id="carModal">
  <div class="car-detail-modal">
    <div class="modal-header">
      <h2 class="modal-title" id="modalCarTitle">Car Details</h2>
      <button class="close-modal" id="closeModal">&times;</button>
    </div>
    <div class="modal-content">
      <div class="car-images">
        <img src="" alt="Car Image" class="primary-image" id="modalPrimaryImage">
        <div class="thumbnails" id="modalThumbnails"></div>
      </div>
      <div class="car-details" id="carDetails"></div>
    </div>
    <div class="modal-footer">
      <div class="nav-buttons">
        <button class="nav-btn" id="prevCar">Previous Car</button>
        <button class="nav-btn" id="nextCar">Next Car</button>
      </div>
      <button class="modal-reserve-btn" id="modalReserveBtn">Reserve This Car</button>
    </div>
  </div>
</div>

<!-- Agents Modal -->
<div class="agents-modal" id="agentsModal">
  <div class="agents-header">
    <h3 class="agents-title">Contact Our Sales Team</h3>
    <button class="close-agents" id="closeAgents">&times;</button>
  </div>
  <div class="agents-message">
    <p>For reservations and enquiries about this vehicle, please contact one of our sales agents:</p>
  </div>
  <div class="agents-list" id="agentsList"></div>
  <div class="agents-footer">
    <button class="exit-reserve" id="exitReserve">Exit Reservation</button>
  </div>
</div>

<style>
/* Reset and Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

:root {
  --primary-color: #1a73e8;
  --primary-dark: #0d5bb9;
  --secondary-color: #f8f9fa;
  --accent-color: #ff6b35;
  --text-color: #333;
  --light-text: #666;
  --border-color: #e0e0e0;
  --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.15);
  --transition: all 0.3s ease;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}

/* Featured Cars Section */
.featured-cars {
  padding: 60px 0;
  background: #f8f9fa;
}

.section-title {
  text-align: center;
  margin-bottom: 40px;
}

.section-title h2 {
  font-size: 32px;
  color: var(--text-color);
  font-weight: 600;
}

/* Cars Grid */
.cars-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 25px;
  margin-bottom: 40px;
}

.car-card {
  background-color: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: var(--transition);
  cursor: pointer;
  position: relative;
}

.car-card:hover {
  transform: translateY(-8px);
  box-shadow: var(--shadow-lg);
}

.car-image-container {
  position: relative;
  height: 200px;
  overflow: hidden;
}

.car-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: var(--transition);
}

.car-card:hover .car-image {
  transform: scale(1.08);
}

.reserve-btn {
  position: absolute;
  bottom: 15px;
  right: 15px;
  background-color: var(--accent-color);
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 4px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  z-index: 10;
}

.reserve-btn:hover {
  background-color: #e55a2b;
  transform: scale(1.05);
}

.car-info {
  padding: 18px;
}

.caplicity-brand {
  font-weight: 700;
  color: #1a73e8;
  font-size: 14px;
  margin-bottom: 5px;
  letter-spacing: 0.5px;
}

.car-name {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 8px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.car-id {
  font-size: 12px;
  color: var(--light-text);
  margin-bottom: 8px;
  font-weight: 500;
}

.car-year-price {
  display: flex;
  justify-content: space-between;
  color: var(--light-text);
  margin-bottom: 12px;
}

.car-price {
  font-weight: 600;
  color: var(--accent-color);
  font-size: 18px;
}

.car-specs {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  color: var(--light-text);
}

/* Status Badges */
.status-badge {
  position: absolute;
  top: 12px;
  left: 12px;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  z-index: 5;
}

.status-available {
  background-color: #28a745;
  color: white;
}

.status-incoming {
  background-color: #ffc107;
  color: #000;
}

.status-sold {
  background-color: #6c757d;
  color: white;
}

/* View All Button */
.view-all-btn {
  background: #00AEEF;
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 8px;
  font-weight: 600;
  text-decoration: none;
  display: inline-block;
  transition: var(--transition);
}

.view-all-btn:hover {
  background: #0099d6;
  transform: translateY(-2px);
}

/* Modal Styles */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.modal-overlay.active {
  display: flex;
}

.car-detail-modal {
  background-color: white;
  border-radius: 12px;
  width: 90%;
  max-width: 1100px;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid var(--border-color);
}

.modal-title {
  font-size: 24px;
  font-weight: 600;
}

.close-modal {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--light-text);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.close-modal:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.modal-content {
  padding: 25px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
}

.car-images {
  display: flex;
  flex-direction: column;
}

.primary-image {
  width: 100%;
  height: 350px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 15px;
}

.thumbnails {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

.thumbnail {
  width: 100%;
  height: 100px;
  object-fit: cover;
  border-radius: 6px;
  cursor: pointer;
  transition: var(--transition);
}

.thumbnail:hover {
  transform: scale(1.05);
}

.thumbnail.active {
  border: 3px solid var(--primary-color);
  transform: scale(1.05);
}

.car-details {
  display: flex;
  flex-direction: column;
}

.detail-item {
  margin-bottom: 18px;
  padding-bottom: 18px;
  border-bottom: 1px solid var(--border-color);
}

.detail-label {
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--primary-color);
  font-size: 16px;
}

.features-list {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-top: 10px;
}

.feature-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px;
  background-color: rgba(26, 115, 232, 0.05);
  border-radius: 6px;
}

.feature-item::before {
  content: "âœ“";
  color: var(--accent-color);
  font-weight: bold;
}

.modal-footer {
  display: flex;
  justify-content: space-between;
  padding: 20px;
  border-top: 1px solid var(--border-color);
}

.nav-buttons {
  display: flex;
  gap: 10px;
}

.nav-btn {
  background-color: var(--primary-color);
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  transition: var(--transition);
}

.nav-btn:hover {
  background-color: var(--primary-dark);
}

.modal-reserve-btn {
  background-color: var(--accent-color);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
}

.modal-reserve-btn:hover {
  background-color: #e55a2b;
}

/* Agents Modal */
.agents-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  border-radius: 12px;
  padding: 25px;
  width: 90%;
  max-width: 700px;
  box-shadow: var(--shadow-lg);
  z-index: 1100;
  display: none;
}

.agents-modal.active {
  display: block;
}

.agents-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--border-color);
}

.agents-title {
  font-size: 22px;
  font-weight: 600;
}

.close-agents {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--light-text);
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.agents-message {
  margin-bottom: 20px;
  text-align: center;
  color: var(--light-text);
}

.agents-list {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 20px;
}

.agent-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 20px;
  border-radius: 10px;
  background-color: var(--secondary-color);
}

.agent-photo {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  margin-bottom: 15px;
  background-color: #ddd;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--light-text);
  font-size: 36px;
}

.agent-name {
  font-weight: 600;
  margin-bottom: 5px;
  font-size: 18px;
}

.agent-role {
  font-size: 14px;
  color: var(--light-text);
  margin-bottom: 15px;
}

.agent-action {
  background-color: var(--primary-color);
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  width: 100%;
  font-weight: 600;
}

.agent-action:hover {
  background-color: var(--primary-dark);
}

.agents-footer {
  text-align: center;
}

.exit-reserve {
  background-color: var(--light-text);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}

.exit-reserve:hover {
  background-color: #555;
}

/* Responsive Design */
@media (max-width: 992px) {
  .modal-content {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .cars-grid {
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  }
  
  .features-list {
    grid-template-columns: 1fr;
  }
  
  .agents-list {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 576px) {
  .cars-grid {
    grid-template-columns: 1fr;
  }
  
  .modal-footer {
    flex-direction: column;
    gap: 15px;
  }
  
  .nav-buttons {
    justify-content: center;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Your existing car data
  const featuredCars = [
    {
      id: "CAP-F001",
      name: "Mazda CX-5 2020",
      images: [
        "https://i.imgur.com/FgynEtr.jpeg",
        "https://i.imgur.com/KTH4LRJ.jpeg",
        "https://i.imgur.com/KH1Dlbk.jpeg",
        "https://i.imgur.com/Tu933Ii.jpeg",
        "https://i.imgur.com/c7lbbdJ.jpeg"
      ],
      fuel: "Petrol",
      price: "KSh 3.45M",
      year: 2020,
      transmission: "6-Speed Manual",
      engine: "2000cc",
      mileage: "39,000 km",
      color: "Gray Exterior, Dark Leather Upholstery",
      body: "SUV",
      location: "Nairobi",
      stockID: "MZ-CX520-2020",
      status: "Available",
      features: [
        "Multimedia Navigation Knob",
        "Electric Handbrake with AutoHold",
        "Multifunction Steering Wheel Controls",
        "Apple CarPlay & Android Auto",
        "Daytime Running Lights",
        "Foglights",
        "Keyless Entry",
        "Auto Start Stop",
        "Push to Start",
        "260km/hr Speed Limit"
      ],
      agents: [0, 1]
    },
    {
      id: "CAP-F002",
      name: "2018 Mercedes Benz GLC220D 4MATIC",
      images: [
        "https://i.imgur.com/EPZ1pSd.jpeg",
        "https://i.imgur.com/PMnvkfF.jpeg",
        "https://i.imgur.com/X05JCL0.jpeg",
        "https://i.imgur.com/lRekYQ1.jpeg",
        "https://i.imgur.com/mvmRbeM.jpeg",
        "https://i.imgur.com/hejOc7s.jpeg"
      ],
      fuel: "Diesel",
      price: "KSh 6.3M",
      year: 2018,
      transmission: "Automatic",
      engine: "2200cc",
      mileage: "N/A",
      color: "Polar White Exterior, Black Leather Interior",
      body: "SUV",
      location: "N/A",
      stockID: "MB-GLC18",
      status: "Available",
      features: [
        "Sunroof",
        "Lane Assist",
        "Heads-up Display",
        "Blind Monitoring System",
        "Traffic Sign Recognition System",
        "Dual Exhaust",
        "Parking Sensors",
        "Steering Wheel Controls"
      ],
      agents: [0, 2]
    },
    {
      id: "CAP-F003",
      name: "2018 Mazda Demio",
      images: [
        "https://i.ibb.co/pvzVmBZG/Whats-App-Image-2025-10-03-at-10-10-45-PM-1.jpg",
        "https://i.ibb.co/hF2kgJgc/Whats-App-Image-2025-10-03-at-10-10-45-PM.jpg",
        "https://i.ibb.co/sd1cnH3F/Whats-App-Image-2025-10-03-at-10-10-44-PM.jpg",
        "https://i.ibb.co/99VpRnF6/Whats-App-Image-2025-10-03-at-10-10-42-PM-1.jpg",
        "https://i.ibb.co/C5cs7VTS/Whats-App-Image-2025-10-03-at-10-10-42-PM.jpg",
        "https://i.ibb.co/cj5Q3xF/Whats-App-Image-2025-10-03-at-10-10-43-PM.jpg"
      ],
      fuel: "Petrol",
      price: "KSh 1.35M",
      year: 2018,
      transmission: "Automatic",
      engine: "1300cc",
      mileage: "N/A",
      color: "Pearl White Exterior, Fabric Upholstery",
      body: "Hatchback",
      location: "N/A",
      stockID: "MD-18",
      status: "Available",
      features: [
        "Multimedia steering controls",
        "Multimedia navigation knob",
        "Sport mode",
        "FM/DVD/Bluetooth touchscreen player",
        "Parking sensors",
        "Blindspot monitoring",
        "Lane departure alert",
        "I-stop technology",
        "Traction control",
        "Alloy rims"
      ],
      agents: [1, 3]
    },
   
  ];

  // Agents data
  const agents = [
    { name: "John Kamau", role: "Sales Manager", number: "+254712345678", photo: "ðŸ‘¨ðŸ¾â€ðŸ’¼" },
    { name: "Sarah Wanjiku", role: "Sales Executive", number: "+254723456789", photo: "ðŸ‘©ðŸ¾â€ðŸ’¼" },
    { name: "David Ochieng", role: "Sales Consultant", number: "+254734567890", photo: "ðŸ‘¨ðŸ¾â€ðŸ’¼" },
    { name: "Grace Akinyi", role: "Customer Relations", number: "+254745678901", photo: "ðŸ‘©ðŸ¾â€ðŸ’¼" },
    { name: "Michael Mwangi", role: "Finance Specialist", number: "+254756789012", photo: "ðŸ‘¨ðŸ¾â€ðŸ’¼" }
  ];

  // DOM Elements
  const featuredCarsContainer = document.getElementById('featuredCarsContainer');
  const carModal = document.getElementById('carModal');
  const agentsModal = document.getElementById('agentsModal');
  const closeModal = document.getElementById('closeModal');
  const closeAgents = document.getElementById('closeAgents');
  const prevCar = document.getElementById('prevCar');
  const nextCar = document.getElementById('nextCar');
  const modalReserveBtn = document.getElementById('modalReserveBtn');
  const modalCarTitle = document.getElementById('modalCarTitle');
  const modalPrimaryImage = document.getElementById('modalPrimaryImage');
  const modalThumbnails = document.getElementById('modalThumbnails');
  const carDetails = document.getElementById('carDetails');
  const agentsList = document.getElementById('agentsList');
  const exitReserve = document.getElementById('exitReserve');

  // State
  let currentCarIndex = 0;
  let currentCarForReservation = null;

  // Initialize
  function init() {
    displayFeaturedCars();
    setupEventListeners();
  }

  // Display featured cars
  function displayFeaturedCars() {
    featuredCarsContainer.innerHTML = '';
    
    featuredCars.forEach((car, index) => {
      const statusClass = car.status ? `status-${car.status.toLowerCase()}` : '';
      const carCard = document.createElement('div');
      carCard.className = 'car-card';
      carCard.setAttribute('data-car-id', car.id);
      carCard.innerHTML = `
        <div class="car-image-container">
          ${car.status ? `<div class="status-badge ${statusClass}">${car.status}</div>` : ''}
          <img src="${car.images[0]}" alt="${car.name}" class="car-image">
          <button class="reserve-btn" data-car-id="${car.id}">Reserve</button>
        </div>
        <div class="car-info">
          
          <div class="car-name">${car.name}</div>
          <div class="car-id">ID: ${car.id}</div>
          <div class="car-year-price">
            <span>${car.year}</span>
            <span class="car-price">${car.price}</span>
          </div>
          <div class="car-specs">
            <span>${car.transmission}</span>
            <span>${car.fuel}</span>
            <span>${car.mileage}</span>
          </div>
        </div>
      `;
      featuredCarsContainer.appendChild(carCard);
    });
    
    attachCarEventListeners();
  }

  // Attach event listeners to car cards
  function attachCarEventListeners() {
    document.querySelectorAll('.car-card').forEach(card => {
      card.addEventListener('click', (e) => {
        if (e.target.classList.contains('reserve-btn')) {
          e.stopPropagation();
          const carId = card.getAttribute('data-car-id');
          const car = featuredCars.find(c => c.id === carId);
          openAgentsModal(car);
        } else {
          const carId = card.getAttribute('data-car-id');
          openCarModal(carId);
        }
      });
    });
  }

  // Setup event listeners
  function setupEventListeners() {
    closeModal.addEventListener('click', closeCarModal);
    closeAgents.addEventListener('click', closeAgentsModal);
    prevCar.addEventListener('click', showPreviousCar);
    nextCar.addEventListener('click', showNextCar);
    modalReserveBtn.addEventListener('click', () => {
      const car = featuredCars[currentCarIndex];
      openAgentsModal(car);
    });
    exitReserve.addEventListener('click', closeAgentsModal);

    // Close modals on overlay click
    carModal.addEventListener('click', (e) => {
      if (e.target === carModal) closeCarModal();
    });
    
    agentsModal.addEventListener('click', (e) => {
      if (e.target === agentsModal) closeAgentsModal();
    });
  }

  // Open car modal
  function openCarModal(carId) {
    const car = featuredCars.find(c => c.id === carId);
    if (!car) return;
    
    currentCarIndex = featuredCars.findIndex(c => c.id === carId);
    modalCarTitle.textContent = car.name;
    modalPrimaryImage.src = car.images[0];
    modalPrimaryImage.alt = car.name;
    
    // Clear and add thumbnails
    modalThumbnails.innerHTML = '';
    car.images.forEach((image, index) => {
      const img = document.createElement('img');
      img.src = image;
      img.alt = `${car.name} - Image ${index + 1}`;
      img.className = 'thumbnail' + (index === 0 ? ' active' : '');
      img.addEventListener('click', () => {
        modalPrimaryImage.src = image;
        document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
        img.classList.add('active');
      });
      modalThumbnails.appendChild(img);
    });
    
    // Populate car details
    carDetails.innerHTML = '';
    const details = [
    
      { label: 'Price', value: car.price },
      { label: 'Year', value: car.year },
      { label: 'Transmission', value: car.transmission },
      { label: 'Fuel Type', value: car.fuel },
      { label: 'Mileage', value: car.mileage },
      { label: 'Body', value: car.body },
      { label: 'Location', value: car.location },
      { label: 'Stock ID', value: car.stockID },
      { label: 'Status', value: car.status },
      { label: 'Features', value: car.features, isFeatures: true }
    ];
    
    details.forEach((detail) => {
      if (!detail.value || (Array.isArray(detail.value) && detail.value.length === 0)) return;
      
      const detailItem = document.createElement('div');
      detailItem.className = 'detail-item';
      
      if (detail.isFeatures && Array.isArray(detail.value)) {
        const featuresList = document.createElement('div');
        featuresList.className = 'features-list';
        detail.value.forEach(feature => {
          const featureItem = document.createElement('div');
          featureItem.className = 'feature-item';
          featureItem.textContent = feature;
          featuresList.appendChild(featureItem);
        });
        detailItem.innerHTML = `<div class="detail-label">${detail.label}</div>`;
        detailItem.appendChild(featuresList);
      } else {
        detailItem.innerHTML = `
          <div class="detail-label">${detail.label}</div>
          <div>${detail.value}</div>
        `;
      }
      carDetails.appendChild(detailItem);
    });
    
    carModal.classList.add('active');
  }

  // Close car modal
  function closeCarModal() {
    carModal.classList.remove('active');
  }

  // Show previous car
  function showPreviousCar() {
    currentCarIndex = currentCarIndex > 0 ? currentCarIndex - 1 : featuredCars.length - 1;
    openCarModal(featuredCars[currentCarIndex].id);
  }

  // Show next car
  function showNextCar() {
    currentCarIndex = currentCarIndex < featuredCars.length - 1 ? currentCarIndex + 1 : 0;
    openCarModal(featuredCars[currentCarIndex].id);
  }

  // Open agents modal
  function openAgentsModal(car) {
    if (!car) return;
    
    currentCarForReservation = car;
    agentsList.innerHTML = '';
    
    // Get agents for this car
    const carAgents = car.agents.map(index => agents[index]);
    
    carAgents.forEach(agent => {
      const formattedNumber = agent.number.replace(/\s+/g, '').replace(/-/g, '');
      const message = `Hello, I am interested in reserving the ${car.name} (ID: ${car.id}). Please provide more details.`;
      const encodedMessage = encodeURIComponent(message);
      const whatsappUrl = `https://wa.me/${formattedNumber}?text=${encodedMessage}`;
      
      const agentItem = document.createElement('div');
      agentItem.className = 'agent-item';
      agentItem.innerHTML = `
        <div class="agent-photo">${agent.photo}</div>
        <div class="agent-name">${agent.name}</div>
        <div class="agent-role">${agent.role}</div>
        <a class="agent-action" href="${whatsappUrl}" target="_blank">Chat on WhatsApp</a>
      `;
      agentsList.appendChild(agentItem);
    });
    
    agentsModal.classList.add('active');
  }

  // Close agents modal
  function closeAgentsModal() {
    agentsModal.classList.remove('active');
  }

  // Initialize the page
  init();
});
</script>