<!-- Homepage Search -->
<div class="search-container">
  <form id="carSearchForm">
    <input type="text" id="carSearchInput" placeholder="Search cars by brand, model, year...">
    <button type="submit">
      <i class="search-icon"></i>
      <span class="search-text">Search</span>
    </button>
  </form>
  <div id="searchSuggestions" class="search-suggestions"></div>
</div>

<style>
/* Search container styling */
.search-container {
  display: flex;
  flex-direction: column;
  justify-content: center;
  margin: 40px auto;
  width: 100%;
  max-width: 800px;
  padding: 0 15px;
  position: relative;
}

/* Form */
#carSearchForm {
  display: flex;
  width: 100%;
  background: linear-gradient(135deg, #00AEEF, #39FF14);
  border-radius: 50px;
  box-shadow: 0 8px 25px rgba(0, 174, 239, 0.2);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  position: relative;
}

#carSearchForm:focus-within {
  transform: scale(1.03);
  box-shadow: 0 12px 30px rgba(0, 174, 239, 0.4);
}

/* Input */
#carSearchInput {
  flex: 1;
  padding: 16px 20px;
  border: none;
  outline: none;
  font-size: 1.1rem;
  border-radius: 50px 0 0 50px;
  background: #ff69b4;
  color: #fff;
  transition: all 0.3s ease;
}

#carSearchInput:focus {
  background: #ff1493;
}

#carSearchInput::placeholder {
  color: rgba(255,255,255,0.8);
}

/* Button */
#carSearchForm button {
  background: linear-gradient(135deg, #00AEEF, #39FF14);
  color: white;
  border: none;
  padding: 0 28px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  border-radius: 0 50px 50px 0;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
  overflow: hidden;
}

#carSearchForm button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  transition: left 0.5s;
}

#carSearchForm button:hover::before {
  left: 100%;
}

#carSearchForm button:hover {
  box-shadow: 0 6px 20px rgba(0, 174, 239, 0.6);
  transform: translateY(-2px);
}

#carSearchForm button:active {
  transform: translateY(1px);
}

/* Search icon animation */
.search-icon {
  display: inline-block;
  width: 20px;
  height: 20px;
  position: relative;
}

.search-icon::before,
.search-icon::after {
  content: '';
  position: absolute;
  transition: all 0.3s ease;
}

.search-icon::before {
  width: 12px;
  height: 12px;
  border: 2px solid white;
  border-radius: 50%;
  top: 0;
  left: 0;
}

.search-icon::after {
  width: 8px;
  height: 2px;
  background: white;
  top: 13px;
  left: 11px;
  transform: rotate(45deg);
}

#carSearchForm button:hover .search-icon::before {
  border-color: #ff69b4;
}

#carSearchForm button:hover .search-icon::after {
  background: #ff69b4;
}

/* Search suggestions */
.search-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border-radius: 0 0 20px 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  z-index: 100;
}

.search-suggestions.active {
  max-height: 300px;
  overflow-y: auto;
}

.suggestion-item {
  padding: 12px 20px;
  cursor: pointer;
  border-bottom: 1px solid #f0f0f0;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: background 0.2s ease;
}

.suggestion-item:hover {
  background: #f8f8f8;
}

.suggestion-item:last-child {
  border-bottom: none;
}

.suggestion-item i {
  color: #00AEEF;
}

.suggestion-item.recent {
  color: #666;
}

.suggestion-item.popular {
  color: #ff69b4;
  font-weight: bold;
}

/* Smart button states */
#carSearchForm button.loading .search-text {
  display: none;
}

#carSearchForm button.loading::after {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid transparent;
  border-top: 2px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

#carSearchForm button.success {
  background: linear-gradient(135deg, #39FF14, #00AEEF);
}

#carSearchForm button.error {
  background: linear-gradient(135deg, #FF416C, #FF4B2B);
  animation: shake 0.5s ease;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-5px); }
  40%, 80% { transform: translateX(5px); }
}

/* ====== MOBILE ADJUSTMENTS ====== */
@media(max-width:600px) {
  #carSearchForm {
    flex-direction: row;
    border-radius: 30px;
  }

  #carSearchInput {
    padding: 10px 12px;
    font-size: 1rem;
    border-radius: 30px 0 0 30px;
  }

  #carSearchForm button {
    padding: 10px 16px;
    font-size: 1rem;
    border-radius: 0 30px 30px 0;
  }
  
  .search-text {
    display: none;
  }
  
  #carSearchForm button {
    padding: 10px 15px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchForm = document.getElementById('carSearchForm');
  const searchInput = document.getElementById('carSearchInput');
  const searchButton = searchForm.querySelector('button');
  const suggestionsContainer = document.getElementById('searchSuggestions');
  
  // Sample search data
  const popularSearches = [
    "Toyota Ractis",
    "Toyota Voxy",
    "Nissan Dualis",
    "Mitsubishi Mirage",
    "Toyota Esquire"
  ];
  
  let recentSearches = JSON.parse(localStorage.getItem('carRecentSearches')) || [];
  
  // Show suggestions when input is focused
  searchInput.addEventListener('focus', showSuggestions);
  searchInput.addEventListener('input', showSuggestions);
  
  // Hide suggestions when clicking outside
  document.addEventListener('click', function(e) {
    if (!searchForm.contains(e.target)) {
      hideSuggestions();
    }
  });
  
  // Form submission
  searchForm.addEventListener('submit', function(e) {
    e.preventDefault();
    performSearch();
  });
  
  function showSuggestions() {
    const query = searchInput.value.trim().toLowerCase();
    suggestionsContainer.innerHTML = '';
    
    // Show recent searches if no query
    if (query === '') {
      if (recentSearches.length > 0) {
        suggestionsContainer.innerHTML += '<div class="suggestion-header">Recent Searches</div>';
        recentSearches.slice(0, 3).forEach(item => {
          const div = document.createElement('div');
          div.className = 'suggestion-item recent';
          div.innerHTML = `<i class="fas fa-history"></i> ${item}`;
          div.addEventListener('click', () => {
            searchInput.value = item;
            performSearch();
          });
          suggestionsContainer.appendChild(div);
        });
      }
      
      // Show popular searches
      suggestionsContainer.innerHTML += '<div class="suggestion-header">Popular Searches</div>';
      popularSearches.slice(0, 3).forEach(item => {
        const div = document.createElement('div');
        div.className = 'suggestion-item popular';
        div.innerHTML = `<i class="fas fa-fire"></i> ${item}`;
        div.addEventListener('click', () => {
          searchInput.value = item;
          performSearch();
        });
        suggestionsContainer.appendChild(div);
      });
    } else {
      // Show filtered suggestions
      const allSuggestions = [...new Set([...recentSearches, ...popularSearches])];
      const filtered = allSuggestions.filter(item => 
        item.toLowerCase().includes(query)
      ).slice(0, 5);
      
      if (filtered.length > 0) {
        filtered.forEach(item => {
          const div = document.createElement('div');
          div.className = 'suggestion-item';
          div.innerHTML = `<i class="fas fa-search"></i> ${item}`;
          div.addEventListener('click', () => {
            searchInput.value = item;
            performSearch();
          });
          suggestionsContainer.appendChild(div);
        });
      } else {
        const div = document.createElement('div');
        div.className = 'suggestion-item';
        div.innerHTML = `<i class="fas fa-info-circle"></i> No results for "${query}"`;
        suggestionsContainer.appendChild(div);
      }
    }
    
    suggestionsContainer.classList.add('active');
  }
  
  function hideSuggestions() {
    suggestionsContainer.classList.remove('active');
  }
  
  function performSearch() {
    const query = searchInput.value.trim();
    
    if (query === '') {
      // Show error state
      searchButton.classList.add('error');
      setTimeout(() => {
        searchButton.classList.remove('error');
      }, 1000);
      return;
    }
    
    // Add to recent searches
    if (!recentSearches.includes(query)) {
      recentSearches.unshift(query);
      if (recentSearches.length > 5) {
        recentSearches.pop();
      }
      localStorage.setItem('carRecentSearches', JSON.stringify(recentSearches));
    }
    
    // Show loading state
    searchButton.classList.add('loading');
    
    // Simulate search (replace with actual search logic)
    setTimeout(() => {
      searchButton.classList.remove('loading');
      searchButton.classList.add('success');
      
      // Hide suggestions
      hideSuggestions();
      
      // Perform actual search here
      console.log(`Searching for: ${query}`);
      
      // Reset button after success
      setTimeout(() => {
        searchButton.classList.remove('success');
      }, 1000);
    }, 1000);
  }
});
</script>